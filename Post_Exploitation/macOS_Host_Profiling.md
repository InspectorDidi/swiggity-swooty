# macOS Host Profiling
Commands and files which expose network and local configuration information on a compromised host. Useful immediately after post-exploitation to determine the capabilities of a host and adjusting attacker methodology and TTPs accordingly.

## System Preferences

### Detect default web browser
> This technique can be used for any type of application by providing a different file type or URL scheme. For example to find the application which handles .mp4 files use the content type public.mpeg-4

Python script:

```
#!/usr/bin/python
# defaultBrowserGet.py
# Queries Launch Services for registered handlers of `.html/.xhtml` files as
# well as `http/https` URIs.
from LaunchServices import LSCopyDefaultRoleHandlerForContentType
from LaunchServices import LSCopyDefaultHandlerForURLScheme

htmlHandler = LSCopyDefaultRoleHandlerForContentType("public.html", 0x00000002)
xhtmlHandler = LSCopyDefaultRoleHandlerForContentType("public.xhtml", 0x00000002)
httpHandler = LSCopyDefaultHandlerForURLScheme("http")
httpsHandler = LSCopyDefaultHandlerForURLScheme("https")

print ".HTML handler: {htmlHandler}\n.XHTML handler: {xhtmlHandler}\nHTTP handler: {httpHandler}\nHTTPS handler: {httpsHandler}\n".format(htmlHandler=htmlHandler, xhtmlHandler=xhtmlHandler,httpHandler=httpHandler,httpsHandler=httpsHandler)
```

## Security & Monitoring

### Detect status of Application Firewall
`/usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate`

Output if firewall is enabled :

`Firewall is enabled. (State = 1)`